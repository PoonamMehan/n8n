// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
  // output   = "../node_modules/@prisma/client"
}

datasource db {
  provider = "postgresql"
}

enum AllWebhookMethods {
  GET
  POST
  PUT
}

model Workflow{
  id            Int      @id @default(autoincrement())
  title         String   @unique
  enabled       Boolean  @default(false)
  nodes         Json     @db.JsonB       @default("{}")
  connections   Json     @db.JsonB       @default("{}")
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt      @default(now())
  userId        String   
  user          User      @relation(fields: [userId], references: [id])
}
//TODO: we can add ProjectId (which is just projectname) in Workflow table

model Webhook{
  id                              Int                 @id  @default(autoincrement())
  title                           String 
  production_url                  String
  http_method                     AllWebhookMethods   @default(POST)
  path                            String
  authentication_method           String
  authentication_credentials_id   Int?
  corresponding_workflow_id       Int  
  response_code                   Int?
  no_response_body                Boolean?
  response_data                   Json?                @db.JsonB
  allowed_origins                 Json?                @db.JsonB
  response_headers                Json?                @db.JsonB
}
// SHOULD THE TITLE BE UNIQUE?
// SHOULD THE PRODUCTION TITLE BE UNIQUE? 

model Credentials{
  id          Int       @id  @default(autoincrement())
  title       String  
  platform    String
  data        Json      @db.JsonB
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  userId      String  
  user        User      @relation(fields: [userId], references: [id])
}

model User{
  id           String       @id  @default(uuid())
  username     String       @unique
  email        String       @unique 
  password     String       
  sessions     String[]     @default([])    
  workflows    Workflow[]   
  credentials  Credentials[]  
}

// model Available_Triggers{
//   id           Int     @id  @default(autoincrement())
//   title        String  
//   description  String 
//   parameters   Json    @db.JsonB
// }
//i don't think we need @id, or for that matter any id column here
//n8n, frontend, extra(jo use hota hai woh hi acche se)

// model Available_Actions{
//   id           Int     @id  @default(autoincrement())
//   title        String  
//   description  String?
//   parameters   Json    @db.JsonB
// }

// model Available_Credential_Apps{
//   id           Int     @id  @default(autoincrement())
//   title        String
//   parameters   Json    @db.JsonB
// }